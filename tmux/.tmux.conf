# Vi-style copy mode
set-window-option -g mode-keys vi
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Enable mouse support
set -g mouse on

# Unbind the default prefix
unbind C-b

# Set the new prefix to Ctrl+a
set-option -g prefix C-a

# Allow sending Ctrl+a to apps by pressing it twice
bind-key C-a send-prefix

# Switch panes (prefix + arrow keys)
bind Up select-pane -U
bind Down select-pane -D
bind Left select-pane -L
bind Right select-pane -R

# Resize panes (prefix + Shift + arrow keys)
bind -r S-Up resize-pane -U 5
bind -r S-Down resize-pane -D 5
bind -r S-Left resize-pane -L 10
bind -r S-Right resize-pane -R 10

# Resize panes (Alt + arrow keys, repeatable)
bind -n M-Up resize-pane -U 2
bind -n M-Down resize-pane -D 2
bind -n M-Left resize-pane -L 2
bind -n M-Right resize-pane -R 2

# New splits (Alt+n horizontal, Alt+v vertical)
bind -n M-n split-window -v
bind -n M-v split-window -h

# Display Popups
bind y display-popup \
  -d "#{pane_current_path}" \
  -w 80% \
  -h 80% \
  -E "lazygit"
bind C-n display-popup -E 'bash -i -c "read -p \"Session name: \" name; tmux new-session -d -s \$name && tmux switch-client -t \$name"'
bind j display-popup -E 'bash -c "tmux list-sessions | sed -E \"s/:.*$//\" | grep -v \"^$(tmux display-message -p \"#S\")$\" | fzf --reverse | xargs tmux switch-client -t"'
bind C-r display-popup \
  -d "#{pane_current_path}" \
  -w 90% \
  -h 90% \
  -E "ranger"
bind C-t display-popup \
  -d "#{pane_current_path}" \
  -E "zsh"

# Display Menu - Quick access to dotfiles
bind d display-menu -T "#[align=centre]Dotfiles" -x C -y C \
  ".zshrc"        z "display-popup -E 'nvim ~/.zshrc'" \
  ".tmux.conf"    t "display-popup -E 'nvim ~/dotfiles/tmux/.tmux.conf'" \
  ".wezterm.lua"  w "display-popup -E 'nvim ~/dotfiles/wezterm-config/.wezterm.lua'" \
  "nvim config"   n "display-popup -d '~/dotfiles/nvim' -E 'nvim ~/dotfiles/nvim/init.lua'" \
  "Exit"          q ""